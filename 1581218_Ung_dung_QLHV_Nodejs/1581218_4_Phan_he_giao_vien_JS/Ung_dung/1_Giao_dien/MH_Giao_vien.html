<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1"><title>
	Trường Đại Học An Ninh Nhân Dân
</title><link rel="stylesheet" href="./Template/bootstrap.css"><link rel="stylesheet" type="text/css" media="all" href="./Template/color-theme.css">
<link rel="stylesheet" type="text/css" media="all" href="./Template/webslidemenu.css">
<link rel="stylesheet" href="./Template/owl.carousel.css">
<link rel="stylesheet" href="./Template/owl.theme.css">
<link rel="stylesheet" href="./Template/owl.transitions.css">
<link rel="stylesheet" type="text/css" media="all" href="./Template/dttx.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css"
              integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
<script src="../2_Xu_ly/Xu_ly.js"></script>
</head>
<body style="font-family:Arial;height:auto;overflow-x:hidden">
 <form method="post" action="/" id="mainForm" enctype="multipart/form-data">
        <input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="CA0B0334">
      </div>
      
              <div class="wsmenucontainer clearfix">
                  <div id="khung_menu" class="wsmenucontent overlapblackbg menuclose"></div>
                  <div class="wsmenuexpandermain slideRight">
                      <a id="navToggle" class="animated-arrow slideLeft menuclose"><span></span></a>
                      <div class="search" style="background-color:orangered">                              
                              
                      </div>
                      <a href="MH_Giao_vien.html" class="smallogo"><img src="./Template/logo_m.jpg" height="34px" alt="" style="border-radius:2px;"></a>    
                  </div> 
                  <div class="header">
                      <div class="wrapper clearfix">
                      <div class="container hidden-xs" style="position:relative">
                        <div class="logo clearfix"><a href="MH_Giao_vien.html" title="Responsive Slide Menus"><img src="./Template/logo.jpg" alt="" height="70px"></a></div>                       
                        <div class="searchdestop" style="float:right">                                
                            <div class="btn  CHUC_NANG" data-toggle="collapse" style="float:right">
                                <div class="btn btn-outline-danger" onclick="Xu_ly_Dang_xuat()">Đăng xuất</div>
                            </div>
                        </div>
                    </div>
                      </div>
                    <div class="container-fluid" style="background-color:orangered">
                        <div class="container">
                          <nav class="wsmenu pm_buttoncolor blue-grdt slideLeft clearfix menuclose" style="background-color:orangered">
                              <ul class="mobile-sub wsmenu-list" style="background-color:orangered">
                                  <li><a data-id="trang-chu" class="thuc-don active" href="MH_Giao_vien.html"><i class="fa fa-home"></i><span class="hometext"></span></a></li>
                                  <li>                                    
                                        <div class="CUA_SO_CHUC_NANG" style="background-color:orangered;margin:10px">
                                                <div class="DANH_SACH_CHUC_NANG">
                                                    <div class="btn  CHUC_NANG">
                                                        
                                                    </div>                              
                                                </div>
                                            </div>
                                  </li>   
                                                                 
                              </ul>
                          </nav>
                          
                          </div>
                      </div>
                 </div>      
        <div class="wrapper content" id="noi_dung_chinh">                 
            <div class="container">                
                    <form action="javascript:Xu_ly_Dong_y()">
                            <div class="container-fluid">
                                <div id="form_dang_nhap"style="display:none">
                                    <div class="alert" style="height:10px">
                                         Đăng nhập Giáo viên 
                                    </div>           
                                    <div class="alert" style="height:30px">
                                        <input  id="Th_Ten_dang_nhap"  name="Th_Ten_dang_nhap" required="required"
                                               spellcheck="false" autocomplete="off" value="" />
                                    </div>
                                    <div class="alert" style="height:30px">
                                        <input  id="Th_Mat_khau"  name="Th_Mat_khau" type="password" required="required"
                                               spellcheck="false" autocomplete="off" value="" />
                                    </div>
                                    <div class="alert" style="height:40px">
                                        <button id="Dong_y" class="btn btn-danger" type="submit" onclick="Xu_ly_Dong_y()">Đồng ý</button>
                                    </div>
                                </div>
                                <div id='Th_Giao_vien'></div>
                                <div id='Th_Vai_tro' style="float:right"></div>
                                <div id='Th_Thong_bao'></div>
                                <div id='Th_Danh_sach_Lop'></div>
                                <div id='Th_Danh_sach_Sinh_vien'></div>
                                <div id='Th_Sinh_vien'></div> 
                                <div id='Th_Chi_tiet_Sinh_vien'></div>
                            </div>
                        </form>                                                                   
            </div>         
        </div>                                   
    </div>

                  <div style="clear:both"></div>  
                  <div class="footer">
                    <div class="container" style="min-height:30px">
                          <div class="col-sm-12">
                    <div style="padding-top:15px;font-size:13px;white-space: nowrap;overflow:hidden">
                      <div class="col-md-4 nhomcs">
                        <div class="tencs">
                          <b>Trường Đại Học An Ninh Nhân Dân</b></div>
                        <div>
                          <i class="fa fa-map-marker" aria-hidden="true" style="margin-right:5px; font-size:14px"></i>Km 18, xa lộ Hà Nội, P.Linh Trung, Q.Thủ Đức, TP.HCM</div>
                        <div>
                          <i class="fa fa-phone-square" aria-hidden="true" style="margin-right:5px; font-size:14px"></i> Điện thoại: 028.79797979</div>
                      </div>
                   
                      <div class="col-md-4 col-md-offset-4 nhomcs">
                        <div class="tencs">
                          <b>Kết nối với chúng tôi:</b></div>
                   
                        <div style="margin-top :12px;"><a href="https://www.facebook.com/AnNinhNhanDanTPHCM/" target="_blank"><i class="fa fa-facebook-square" aria-hidden="true" style="font-size:40px; color:#ffffff"></i></a></div>
                                  </div>
                    </div>
                  </div>
                        <div style="clear: both"></div>
                      </div>
                  </div>                 
                  
              </div>
 </form>         
          <script type="text/javascript" src="./Template/jquery.min.js.download"></script>
          <script type="text/javascript" src="./Template/bootstrap.js.download"></script>
          <script type="text/javascript" src="./Template/webslidemenu.js.download"></script>
          <script type="text/javascript" src="./Template/owl.carousel.js.download"></script>
          <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"
        integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
             
      <script type="text/javascript">
      var Danh_sach_Lop = Doc_Danh_sach_Lop()
    var Danh_sach_Sinh_vien = Doc_Danh_sach_Sinh_vien()
    var Danh_sach_Giao_vien = Doc_Danh_sach_Giao_vien()
    var Giao_vien_dang_nhap
    function GetURLParameter(sParam) {
            var sPageURL = window.location.search.substring(1);
            var sURLVariables = sPageURL.split('&');
            if (sURLVariables.length != 2){
                return 0;
            }
            for (var i = 0; i < sURLVariables.length; i++) {
                var sParameterName = sURLVariables[i].split('=');
                if (sParameterName[0] == sParam) {
                    return sParameterName[1];
                }
            } 
        }
   function Xu_ly_Dong_y(){    
    var Ten_dang_nhap = GetURLParameter('Th_Ten_dang_nhap'); // Nhập liệu
    var Mat_khau = GetURLParameter('Th_Mat_khau'); // Nhập liệu
       var Giao_vien = {} // Biến Kq
       var Hop_le = Danh_sach_Giao_vien.some(x => x.Ten_dang_nhap == Ten_dang_nhap
           && x.Mat_khau == Mat_khau)
       if (Hop_le) {
           Giao_vien = Danh_sach_Giao_vien.find(x => x.Ten_dang_nhap == Ten_dang_nhap
               && x.Mat_khau == Mat_khau)
           Giao_vien.Danh_sach_Dang_nhap.push(new Date())
           document.getElementById("form_dang_nhap").innerHTML = "";
           var Danh_sach_Lop_cua_Giao_vien=Tao_Danh_sach_Lop_cua_Giao_vien(
              Giao_vien,Danh_sach_Lop)
            var Danh_sach_Sinh_vien_cua_Giao_vien=Tao_Danh_sach_Sinh_vien_cua_Giao_vien(
              Giao_vien,Danh_sach_Sinh_vien)
            Th_Giao_vien.innerHTML=Tao_Chuoi_HTML_Giao_vien_Khi_Chao(Giao_vien)
             Th_Thong_bao.innerHTML=`Anh/chị được phân công 
               ${Danh_sach_Lop_cua_Giao_vien.length} lớp 
               với ${Danh_sach_Sinh_vien_cua_Giao_vien.length} sinh viên `
            Th_Danh_sach_Lop.innerHTML=Tao_Chuoi_HTML_Danh_sach_Lop(
                 Danh_sach_Lop_cua_Giao_vien)
            Th_Danh_sach_Sinh_vien.innerHTML=Tao_Chuoi_HTML_Danh_sach_Sinh_vien(Giao_vien,
                Danh_sach_Sinh_vien_cua_Giao_vien) 
           //=== Ghi 
            
            Ghi_Giao_vien(Giao_vien)
            Giao_vien_dang_nhap = Giao_vien

            var Chuoi_HTML_Danh_sach_Nhom_nguoi_dung = `<select id="mySelect" onchange="Chuyen_doi_vai_tro()">`
                    var Ma_so_Nhom_nguoi_dung = Giao_vien_dang_nhap.Nhom_Nguoi_dung.Ma_so
                    var DS_Vai_tro = Giao_vien_dang_nhap.Danh_sach_Nhom_Nguoi_dung
                    for (var i = 0; i < DS_Vai_tro.length; i++){
                        if (Ma_so_Nhom_nguoi_dung == DS_Vai_tro[i].Ma_so){
                            Chuoi_HTML_Danh_sach_Nhom_nguoi_dung += `<option selected>${DS_Vai_tro[i].Ten}</option>`

                        }
                        else{
                            Chuoi_HTML_Danh_sach_Nhom_nguoi_dung += `<option>${DS_Vai_tro[i].Ten}</option>`
                        }                    
                    }
                    Chuoi_HTML_Danh_sach_Nhom_nguoi_dung += `</select>`

                    Th_Vai_tro.innerHTML = `<div><h5 style="color:red">Chọn nhóm người dùng: `+ Chuoi_HTML_Danh_sach_Nhom_nguoi_dung + `</h5></div>`
      }
      else {
        Th_Giao_vien.innerHTML=""
        Th_Danh_sach_Lop.innerHTML=""
        Th_Danh_sach_Sinh_vien.innerHTML=""
        Th_Sinh_vien = ""
        Th_Chi_tiet_Sinh_vien.innerHTML=""
        Th_Thong_bao.innerHTML=""
      }
   }    
        function Xu_ly_cho_diem_Sinh_vien(Ma_so){
            var Sinh_vien = Tim_Sinh_vien(Ma_so, Danh_sach_Sinh_vien)
            Th_Danh_sach_Sinh_vien.innerHTML = ""
            Th_Sinh_vien.innerHTML = Tao_Chuoi_HTML_Sinh_vien(Sinh_vien)
            Th_Chi_tiet_Sinh_vien.innerHTML =`<div class='alert' style='height:40px; float:left'><button class='btn btn-danger' onclick="Xu_ly_Qua_trinh_hoc_tap('${Ma_so}')">Quá trình học tập</button></div><div class='alert' style='height:40px; float:left'><button class='btn btn-danger' onclick="Xu_ly_Cho_diem('${Ma_so}')">Nhập điểm</button></div>`
        }
        
        function Xu_ly_Qua_trinh_hoc_tap(Ma_so){
            var Sinh_vien = Tim_Sinh_vien(Ma_so, Danh_sach_Sinh_vien)
            Th_Chi_tiet_Sinh_vien.innerHTML = `<div class='alert' style='height:40px; float:left'><button class='btn btn-danger' onclick="Xu_ly_Qua_trinh_hoc_tap('${Ma_so}')">Quá trình học tập</button></div><div class='alert' style='height:40px; float:left'><button class='btn btn-danger' onclick="Xu_ly_Cho_diem('${Ma_so}')">Nhập điểm</button></div>`+Tao_Chuoi_HTML_Danh_sach_Diem(Sinh_vien)
        }   
        function Xu_ly_Cho_diem(Ma_so){
            var Sinh_vien = Tim_Sinh_vien(Ma_so, Danh_sach_Sinh_vien)
            Th_Chi_tiet_Sinh_vien.innerHTML = `<div class='alert' style='height:40px; float:left'><button class='btn btn-danger' onclick="Xu_ly_Qua_trinh_hoc_tap('${Ma_so}')">Quá trình học tập</button></div><div class='alert' style='height:40px; float:left'><button class='btn btn-danger' onclick="Xu_ly_Cho_diem('${Ma_so}')">Nhập điểm</button></div>`+Tao_Chuoi_HTML_Nhap_Diem(Giao_vien_dang_nhap, Ma_so)
        } 
        function Xu_ly_Ghi_diem (Ma_so){
            var Sinh_vien = Tim_Sinh_vien(Ma_so, Danh_sach_Sinh_vien)
            var Diem_mon_hoc = {
            "Nien_khoa": "",
			"Hoc_ky": "",
			"Ma_mon": "",
			"Ten_lop_hoc": "",
			"Loai_diem": "",
            "Diem": ""
            }
            var id_nien_khoa = 'Nien_khoa' + '_' + Ma_so
            var id_hoc_ky = 'Hoc_ky'+ '_' + Ma_so
            var id_ma_mon = 'chon_ma_mon'+ '_' + Ma_so
            var id_ten_lop_hoc = 'chon_lop_hoc'+ '_' + Ma_so
            var id_loai_diem = 'Loai_diem'+ '_' + Ma_so
            var id_diem = 'Diem'+ '_' + Ma_so
            
            Diem_mon_hoc.Nien_khoa = document.getElementById(id_nien_khoa).innerHTML
            Diem_mon_hoc.Hoc_ky = document.getElementById(id_hoc_ky).innerHTML
            Diem_mon_hoc.Ma_mon = document.getElementById(id_ma_mon).value
            Diem_mon_hoc.Ten_lop_hoc = document.getElementById(id_ten_lop_hoc).value
            Diem_mon_hoc.Loai_diem = document.getElementById(id_loai_diem).value
            Diem_mon_hoc.Diem = document.getElementById(id_diem).value

            var kiem_tra_hop_le = Diem_mon_hoc.Loai_diem != "" && Diem_mon_hoc.Diem != ""
            if (kiem_tra_hop_le == true){
                Sinh_vien.Qua_trinh_hoc_tap.push(Diem_mon_hoc)
                Ghi_Diem(Sinh_vien)
                alert("Đã ghi điểm thành công")
            }
            else {
                alert("Du lieu khong hop le")
            }  
    }
        function Dong_bo_ma_mon_va_ten_mon(Ma_so_Sinh_vien){
            var Danh_sach_Mon_day = Giao_vien_dang_nhap.Danh_sach_Mon_day
            var id_chon_ma_mon = 'chon_ma_mon_'+ Ma_so_Sinh_vien
            var id_chon_lop_hoc = 'chon_lop_hoc_'+ Ma_so_Sinh_vien
            var ma_mon_chon = document.getElementById(id_chon_ma_mon).value
            for (var i = 0; i < Danh_sach_Mon_day.length; i++){
                if (Danh_sach_Mon_day[i].Ma_mon == ma_mon_chon){
                    document.getElementById(id_chon_lop_hoc).selectedIndex = i
                }
            }
        }     
        function Dong_bo_ten_mon_va_ma_mon(Ma_so_Sinh_vien){
            var Danh_sach_Mon_day = Giao_vien_dang_nhap.Danh_sach_Mon_day
            var id_chon_ma_mon = 'chon_ma_mon_'+ Ma_so_Sinh_vien
            var id_chon_lop_hoc = 'chon_lop_hoc_'+ Ma_so_Sinh_vien
            var ten_mon_chon = document.getElementById(id_chon_lop_hoc).value
            for (var i = 0; i < Danh_sach_Mon_day.length; i++){
                if (Danh_sach_Mon_day[i].Ten_lop_hoc == ten_mon_chon){
                    document.getElementById(id_chon_ma_mon).selectedIndex = i
                }
            }
        }    
    function Chuyen_doi_vai_tro(){
            var Danh_sach_Nhom_Nguoi_dung = Giao_vien_dang_nhap.Danh_sach_Nhom_Nguoi_dung
            for (var i = 0; i < Danh_sach_Nhom_Nguoi_dung.length;i++){
                if (Danh_sach_Nhom_Nguoi_dung[i].Ten == document.getElementById("mySelect").value){
                    var Ten_dang_nhap = Danh_sach_Nhom_Nguoi_dung[i].Ten_dang_nhap
                    var Mat_khau = Danh_sach_Nhom_Nguoi_dung[i].Mat_khau
                    window.location.href ="../../../1581218_1_Phan_he_khach_tham_quan_JS/Ung_dung/1_Giao_dien/MH_Chinh.html?"+"Th_Ten_dang_nhap=" + Ten_dang_nhap +"&Th_Mat_khau="+Mat_khau
                }
            }
        }
   function Xu_ly_Dang_xuat(){
            window.location.href ="../../../1581218_1_Phan_he_khach_tham_quan_JS/Ung_dung/1_Giao_dien/MH_Chinh.html"              
        }
    $(document).ready(function(){ 
    //Tự động click
    if (GetURLParameter('Th_Ten_dang_nhap') != 0 && GetURLParameter('Th_Mat_khau') != 0){
    document.getElementById('Dong_y').click();
    }
    });
        </script>       
</body>

</html>








